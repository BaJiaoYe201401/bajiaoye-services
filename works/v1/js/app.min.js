var app=window.app||{};app.fn=app.fn||{},app.fn.loader=function(){function a(){var a=$("#loaderImg"),c=app.global.shareImage;a.css({"background-image":"url(images/"+c+")"}),b()}function b(){c(app.global),c(app.startAnimate),c(app.contentPageList),d()}function c(a){for(var b in a)if("object"==typeof a[b])c(a[b]);else{var d=a[b],f=/\.(?:jpe?g|gif|png|bmp)$/i;f.test(d)&&e.push(d)}}function d(){for(var a='<div id="appLoadImgbox">',b=0,c=e.length;c>b;b++)a+='<img onload="window.appLoader()" src="images/'+e[b]+'"/>';a+="</html>",$(a).appendTo($(document.body))}var e=[],f=0;a(),window.appLoader=function(){f++,f===e.length&&($("#pageContent .page").each(function(a){a>0&&$(this).addClass("disNone")}),$("#loaderBox").animate({opacity:0},1e3,function(){$(this).remove(),$("#appLoadImgbox").remove()}))}},app.fn.loader();var app=window.app||{};app.fn=app.fn||{},app.fn.share=function(){function a(a){$.ajax({type:"get",url:"http://bajiaoye.cn:8000/bjyservice/index.php/getSignature",data:{url:encodeURIComponent(c)},success:function(b){"string"==typeof b&&(b=JSON.parse(b),a(b))},error:function(a){console.log(a)}})}function b(a){a.jsApiList=["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareWeibo"],wx.config(a),wx.ready(function(){wx.onMenuShareTimeline({desc:d.pageDescribe,title:d.pageTitle,link:c,imgUrl:h,success:function(){}}),wx.onMenuShareAppMessage({desc:d.pageDescribe,title:d.pageTitle,link:c,imgUrl:h,success:function(){}})}),wx.error(function(a){for(var b in a)alert(b+"--"+a[b])})}var c=location.href,d=app.global,e=/^.*\?/i,f=c.match(e),g="";f&&(g=f[0].replace("?",""));var h=g+"images/"+d.shareImage;a(b)};var app=window.app||{};app.fn=app.fn||{},app.instance=app.instance||{},app.fn.getCss=function(){for(var a=10,b="",c=["left","top","right","bottom"],d=function(a){for(var b="",d=0,e=c.length;e>d;d++){b+="."+c[d]+a+"{"+c[d]+":"+-1*a+"%;} ";var f="to"+c[d]+"0_from"+c[d]+a,g=f+"_ani",h=.01*a;b+="."+f+"{-webkit-animation: "+g+" "+h+"s ease-out;} ",b+="@-webkit-keyframes  "+g+"{",b+="100%{ "+c[d]+":0; } } "}return b},e=0;a>e;e++)numVal=10+10*e,b+=d(numVal);for(var f=0,g=c.length;g>f;f++)b+="."+c[f]+"0{"+c[f]+":0;} ";return b},app.instance.common=new function(){var a=this,b=$(window).width(),c=$(window).height();a.pageSize={width:b,height:c},a.musicIcon=$("#musicIcon"),a.startBox=$("#startBox"),a.pageContent=$("#pageContent"),a.loadBox=$("#loadBox"),a.loadPage=$("#loadPage"),a.checkKey=function(a,b){for(var c=0,d=a.length;d>c;c++)b[a[c]]||console.log("key="+a[c]+", 没有值请检查，配置文件.")},a.addCss=function(a){try{var b=document.createStyleSheet();b.cssText=a}catch(c){var b=document.createElement("style");b.type="text/css",b.textContent=a,document.getElementsByTagName("HEAD").item(0).appendChild(b)}};var d=app.fn.getCss(),e=app.global.backgroundColor?"body,#loaderBox{background:"+app.global.backgroundColor+"}\n":"";d+=".page{width:"+b+"px; height:"+c+"px;} \n "+e,$("title").text(app.global.pageTitle),a.addCss(d),app.fn.share()};var app=window.app||{};app.fn=app.fn||{},app.fn.clickOpenUpdown=function(a){app.fn.clickOpen(a,"upDown")},app.fn.clickOpenLeftRight=function(a){app.fn.clickOpen(a,"leftRight")},app.fn.clickOpen=function(a,b){var c=$('<canvas width="'+a.pageSize.width+'" height="'+a.pageSize.height+'"></canvas>'),d=c[0].getContext("2d"),e=new Image,f=app.startAnimate;c.appendTo(a.startBox),e.onload=function(){var c=$(e).appendTo($(document.body)).css({visibility:"hidden"}),f=c.width(),g=c.height(),h=f/g,i=a.pageSize.width/a.pageSize.height,j=0,k=0;h>=i?(k=0,j=(h*a.pageSize.height-f)/2):(j=0,k=(a.pageSize.width/h-g)/2),d.drawImage(e,0,0,f,g,0,0,a.pageSize.width,a.pageSize.height),$(e).remove(),"upDown"===b?app.fn.upDownEvt(a,d):"leftRight"===b&&app.fn.leftRightEvt(a,d)},e.src="images/"+f.imgSrc},app.fn.upDownEvt=function(a,b){var c=!1;a.startBox.bind("touchstart",function(d){if(!c){c=!0;{var e=a.pageSize.height/8,f=(a.pageSize.height-e)/2;a.pageSize.width}b.clearRect(0,f,a.pageSize.width,e);var g=function(){setTimeout(function(){var d=(a.pageSize.height-e)/8;4>=d&&(d=4),e+=d,f=(a.pageSize.height-e)/2,0>=f?(c=!1,a.startBox.hide(),app.instance.pageContent.startPageOne&&app.instance.pageContent.startPageOne()):g(),b.clearRect(0,f,a.pageSize.width,e)},30)};return g(),d.stopPropagation(),d.preventDefault(),!1}})},app.fn.leftRightEvt=function(a,b){var c=!1;a.startBox.bind("touchstart",function(d){if(!c){c=!0;var e=a.pageSize.width/8,f=0,g=(a.pageSize.width-e)/2,h=a.pageSize.height;b.clearRect(g,f,e,h);var i=function(){setTimeout(function(){var d=(a.pageSize.width-e)/8;4>=d&&(d=4),e+=d,g=(a.pageSize.width-e)/2,0>=g?(c=!1,a.startBox.hide(),app.instance.pageContent.startPageOne&&app.instance.pageContent.startPageOne()):i(),b.clearRect(g,f,e,h)},30)};return i(),d.stopPropagation(),d.preventDefault(),!1}})};var app=window.app||{};app.fn=app.fn||{},app.fn.wipeScreen=function(a){function b(){var b=app.startAnimate,c='<img src ="images/icon/hand.png" id="startHand"  class="startHand"/><img onload="window.wipeImgload(this)" src="images/'+b.imgSrc+'" id="wipeImg"  class="wipeImg"/>';a.startBox.html(c),a.wipeImg=$("#wipeImg")}function c(){a.stopHand=!0,a.wipeImg.eraser("clear"),a.startHand.animate({opacity:0},500),a.startBox.animate({opacity:0},1e3,function(){a.startBox.hide(),app.instance.pageContent.startPageOne&&app.instance.pageContent.startPageOne()})}function d(){var b=a.startHand,c=null,d=null;c=function(){b.animate({left:"80%",bottom:450},1e3,function(){a.stopHand||d()})},d=function(){b.animate({left:"20%",bottom:350},1e3,function(){a.stopHand||c()})},c()}b(),window.wipeImgload=function(b){$(b).width(),$(b).height();a.wipeImg.eraser({size:75,completeRatio:.2,completeFunction:c}),a.startHand=a.startBox.find("#startHand"),d()}};var app=window.app||{};app.fn=app.fn||{},app.fn.drawWords=function(a){function b(){var b=app.startAnimate,c='<img src ="images/icon/hand.png" id="startHand"  class="startHand"/>'+(b.textImg?'<img src="images/'+b.textImg+'"  id="startTxt" class="disNone"/>':"")+'<img class="hollowImg" onLoad="window.hollowImgLoad(this);" id="startTopImg" src="images/'+b.hollowImg+'" /><div id="startCanvasOut"><canvas width="100%" height="600" id="startCanvas"></canvas></div><img src="images/'+b.solidImg+'" class="solidImg"  id="startBottomImg"/>';a.startBox.html(c),a.startBox.css({height:a.pageSize.height,width:a.pageSize.width,background:"url(images/"+b.background+")"}),a.startTopImg=a.startBox.find("#startTopImg"),a.startCanvas=a.startBox.find("#startCanvas"),a.startBottomImg=a.startBox.find("#startBottomImg"),a.startHand=a.startBox.find("#startHand"),a.startTxt=a.startBox.find("#startTxt"),app.startAnimate.coordinate?a.targetDotList=app.startAnimate.coordinate:console.log("缺少app.startAnimate.coordinate的值,请查看")}function c(){var b=a.startTopImg.width(),c=a.startBottomImg.height();a.startTopImg.css({"z-index":10}),a.startBottomImg.css({"z-index":1}),a.startCanvas.attr({width:b,height:c}),a.startBox.css({height:a.pageSize.height,overflow:"hidden"})}function d(){var b=a.startHand,c=null,d=null;c=function(){b.animate({left:410,top:250},1e3,function(){a.stopHand||d()})},d=function(){b.animate({left:160,top:350},1e3,function(){a.stopHand||c()})},c()}function e(){var b=a.startTopImg.get(0);console.log(b),b.addEventListener("touchstart",f,!1),b.addEventListener("touchmove",h,!1),b.addEventListener("touchend",i,!1),a.startCtx=a.startCanvas.get(0).getContext("2d")}function f(a){a.preventDefault()}function g(b,c){var d=a.startCtx,e=d.getImageData(b*a.rateX,c*a.rateY,1,1);console.log(b*a.rateX+"---"+c*a.rateY);var f=e.data;return f[0]+"_"+f[1]+"_"+f[2]+"_"+f[3]}function h(b){var c=b.touches[0].pageX,d=b.touches[0].pageY,e=a.startCtx,f=[],g=a.startCanvas.offset(),h=g.left,i=g.top;if(c-=h,d-=i,e.beginPath(),e.arc(c,d-2,a.drawSize+2*Math.random(),0,2*Math.PI,!0),e.fill(),f.push({x:c,y:d}),f.length>2){var j=f[f.length-2];e.lineWidth=a.drawSize-2,e.moveTo(j.x,j.y-2),e.lineTo(c,d-2),e.fill(),e.stroke(),e.closePath()}}function i(){var b,c,d,e=!1,f=a.targetDotList,h=f.length,i=0;console.log(JSON.stringify(f));for(var k=0;h>k;k++)b=f[k][0],c=f[k][1],d=g(b,c),"0_0_0_255"===d&&(i+=1);console.log("targetDots="+i),i>=.5*h&&(e=!0),a.stopHand||(a.stopHand=!0,a.startHand.animate({opacity:0},500)),e&&j()}function j(){var b=a.startCtx;b.fillStyle="#000000",b.fillRect(5,5,a.startCanvas.width()-15,a.startCanvas.height()-15),k()}function k(){a.startBox.animate({opacity:0},1e3,function(){$(this).hide(),app.instance.pageContent.startPageOne&&app.instance.pageContent.startPageOne()})}b(),window.hollowImgLoad=function(b){var f=($(b).width(),$(b).height());a.rateY=a.pageSize.height/f,a.rateX=a.rateY,c(),d(),e()}},app.instance.startAnimate=new function(){function a(){function a(){$(h).appendTo($(document.body)),c.myaudio=$("#myaudio"),i=c.myaudio[0],"oncanplaythrough"in document?e():(b(),f(),c.startBox.bind("touchstart",function(){c.firstPlay||(d(),i.play(),k.attr("musicIsPlay","true"),c.firstPlay=!0)}))}function b(){$(j).appendTo($(document.body)),k=$("#musicBox"),l=k.find("#icon-music-img"),c.musicBox=k}function d(){c.musicTimer=setInterval(function(){var a=l.attr("style"),b=/\d+/g,c=parseInt(a.match(b)[0]),d=c+10;d>360&&(d-=360),l.css("transform","rotate("+d+"deg)")},30)}function e(){i.addEventListener("canplaythrough",function(){b(),f(),k.trigger("touchstart")},!1)}function f(){k.bind("touchstart",function(a){var b=$(this).attr("musicIsPlay");return"true"===b?(clearInterval(c.musicTimer),i.pause(),l.css("transform","rotate(0deg)"),$(this).attr("musicIsPlay","false")):"false"===b&&(d(),i.play(),$(this).attr("musicIsPlay","true")),a.stopPropagation(),a.preventDefault(),!1})}var g=app.global.music;if(g&&g.name&&g.hasMusic){var h='<audio id="myaudio" src="images/'+g.name+'"  loop="true" hidden="true"  />',i=null,j='<div musicIsPlay="false" class="icon-music" id="musicBox"><img id="icon-music-img" src="images/icon/icon_music.png" style="transform: rotate(0deg); " /></div>',k=null,l=null;a()}}function b(){c.startBox.removeClass("disNone"),c.loadPage.animate({opacity:0},500,function(){$(this).hide()})}var c=this;c=$.extend(c,app.instance.common),c.type="",c.startHand=null,c.startCtx=null,c.stopHand=!1,c.drawSize=13,start=function(){var d=app.startAnimate.type;switch(b(),a(),c.type=d,d){case"clickOpenUpdown":app.fn.clickOpenUpdown(c);break;case"clickOpenLeftRight":app.fn.clickOpenLeftRight(c);break;case"wipeScreen":app.fn.wipeScreen(c);break;case"drawWords":app.fn.drawWords(c);break;case"invitation":app.fn.invitation(c)}},start()};var app=window.app||{};app.fn=app.fn||{},app.fn.baiduMapFun=function(a){function b(){c(),d(),e(),f()}function c(){var a=new BMap.Map(i),b=new BMap.Point(j,k);a.centerAndZoom(b,18),window.map=a}function d(){map.enableDragging(),map.disableScrollWheelZoom(),map.disableDoubleClickZoom(),map.enableKeyboard()}function e(){}function f(){for(var a=0;a<l.length;a++){var b=l[a],c=b.point.split("|")[0],d=b.point.split("|")[1],e=new BMap.Point(c,d),f=h(b.icon),i=new BMap.Marker(e,{icon:f}),j=(g(a),new BMap.Label(b.title,{offset:new BMap.Size(b.icon.lb-b.icon.x+10,-20)}));i.setLabel(j),map.addOverlay(i),j.setStyle({borderColor:"#808080",color:"#333",cursor:"pointer"}),function(){var c=g(a),d=i;d.addEventListener("click",function(){this.openInfoWindow(c)}),c.addEventListener("open",function(){d.getLabel().hide()}),c.addEventListener("close",function(){d.getLabel().show()}),j.addEventListener("click",function(){d.openInfoWindow(c)}),b.isOpen&&(j.hide(),d.openInfoWindow(c))}()}}function g(a){var b=l[a],c=new BMap.InfoWindow("<b class='iw_poi_title' title='"+b.title+"'>"+b.title+"</b><div class='iw_poi_content'>"+b.content+"</div>");return c}function h(a){var b=new BMap.Icon("http://app.baidu.com/map/images/us_mk_icon.png",new BMap.Size(a.w,a.h),{imageOffset:new BMap.Size(-a.l,-a.t),infoWindowOffset:new BMap.Size(a.lb+5,1),offset:new BMap.Size(a.x,a.h)});return b}var i="baidumapContent",j=Number(a.longitude),k=Number(a.latitude),l=[{title:a.title,content:a.address,point:j+"|"+k,isOpen:0,icon:{w:23,h:25,l:46,t:21,x:9,lb:12}}];b()};var app=window.app||{};app.fn=app.fn||{},app.fn.video=function(){var a=function(a){var b=a.split("-"),c='<span class="videoCloseButton">关闭</span>';return"youku"===b[0]&&(c+='<iframe height=600 width="100%" src="http://player.youku.com/embed/'+b[1]+'" frameborder=0 allowfullscreen></iframe>'),c},b=function(b,c){var d=b.effect?b.effect:"fade",e="",f=b.background,g=f?'style="background-image:url(images/'+f+')"':"",h=a(b.videoUrl);return e='<div effect="'+d+'" type="'+c+'" '+g+' class="page lowZindex disNone">',e+='<div class="markBox disNone" id="markBox"></div>',e+='<div class="likePageBox" style="background:url(images/'+b.videoScreenshot+') no-repeat center center ; background-size:100% auto;"></div>',e+='<div class="videoBtnCover" style="bottom:'+b.verticalPosition+'px;" > </div>',e+='<img class="videoBtn" style="bottom:'+b.verticalPosition+'px;" src="images/'+b.videoButton+'" />',e+='<div videoId="'+b.videoUrl+'" class="videoBox disNone">'+h+"</div></div>"},c=function(b){var c=b.find(".videoBtnCover"),d=(b.find(".videoCloseButton"),app.instance.startAnimate,!1),e=b.find(".markBox");c.bind("touchend",function(){var b=$(this).parent().find(".videoBox"),c=app.instance.pageContent,f=app.instance.startAnimate.musicBox;b.html()||b.html(a(b.attr("videoId"))),b.removeClass("disNone"),e.removeClass("disNone"),c.pageIsMove=!0,console.log("pageContent.pageIsMove="+c.pageIsMove),c.upDownArrow.addClass("disNone"),console.log("musicBox.length="+f.length+"------"+f.attr("musicIsPlay")),f.length>0&&"true"===f.attr("musicIsPlay")&&(f.trigger("touchstart"),d=!0)}),b.on("touchend",".videoCloseButton",function(){var a=app.instance.pageContent,b=app.instance.startAnimate.musicBox;$(this).parent().addClass("disNone").html(""),e.addClass("disNone"),a.pageIsMove=!1,a.upDownArrow.removeClass("disNone"),d&&(b.trigger("touchstart"),d=!1)})};return{buildVideoPage:function(a,c){return b(a,c)},registerEvt:function(a){c(a)}}}(),app.instance.pageContent=new function(){function a(){b()}function b(){var a='<div class="upDownArrow disNone" id="upDownArrow"></div><div class="rightArrow disNone" id="rightArrow"></div><div class="leftArrow disNone" id="leftArrow"></div>';pageNum=E.pageNum,type="",item=null,txtStyleStr="",hasBaiduMap=!1,baiduConfig=null;for(var b=0;b<pageNum;b++)switch(item=E.pageList[b],type=item.type,type){case"common":a+=g(item,type);break;case"gallery":a+=g(item,type);break;case"360":a+=f(item,type);break;case"slide":a+=e(item,type);break;case"album":a+=d(item,type);break;case"map":a+=h(item,type,b);break;case"video":a+=app.fn.video.buildVideoPage(item,type)}E.pageContent.html(a),E.pageList=E.pageContent.find(".page"),E.rightTipBtn=$("#rightArrow"),E.rightArrow=E.rightTipBtn,E.leftArrow=$("#leftArrow"),E.upDownArrow=$("#upDownArrow"),E.pageList.eq(0).removeClass("disNone").find("div").removeClass("disNone"),c(),j(),k()}function c(){var a=$('<div class="opacity0 copyright_info"><a href="http://www.bajiaoye.cn" target="_blank">powered by <span>BaJiaoYe.cn</span></a></div>');$(a).appendTo(E.pageList.eq(E.pageNum-1)),console.log("addClass ok ~~~")}function d(a,b){var c=a.effect?a.effect:"fade",d="120%"===c?"bigSize120":"",e="",f=a.animateImgs,g=a.background,h=g?'style="background-image:url(images/'+g+')"':"",i="";e='<div effect="'+c+'" type="'+b+'" '+h+' class="page albumPage lowZindex '+d+' disNone">';for(var j=0,k=f.length;k>j;j++){i=0===j?"true":"";var l=j;j>2&&(l=2),e+='<img targetClass="albumImgShow'+l+'" class="albumImg" src= "images/'+f[j].src+'" />'}return e+="</div>"}function e(a,b){{var c=a.effect?a.effect:"fade",d="120%"===c?"bigSize120":"",e="",f=a.animateImgs,g=a.background,h=g?'style="background-image:url(images/'+g+')"':"";f.length}e='<div effect="'+c+'" type="'+b+'" '+h+' class="page lowZindex '+d+'">',e+='<div class="swipe-wrap">';for(var i=0,j=f.length;j>i;i++)e+='<div style="background-image:url(images/'+f[i].src+');)"> </div>';return e+="</div></div>"}function f(a,b){{var c=a.effect?a.effect:"fade",d="120%"===c?"bigSize120":"",e="",f=a.animateImgs,g=a.background,h=g?'style="background-image:url(images/'+g+')"':"",i="";f.length}e='<div effect="'+c+'" type="'+b+'" '+h+' class="page lowZindex '+d+' disNone">';for(var j=0,k=f.length;k>j;j++)i=0===j?"true":"",e+='<div slideImg="true" class="likePageBox" '+i+' index="'+j+'" style="background-image:url(images/'+f[j].src+');)"> </div>';return e+="</div>"}function g(a,b){var c=a.effect?a.effect:"fade",d="120%"===c?"bigSize120":"";pageHtml="",animateImgs=a.animateImgs,pageBg=a.background,styleStr=pageBg?'style="background-image:url(images/'+pageBg+');"':"";var e=function(a,b){var c=a.from+a.position.replace("%",""),d="to"+a.from+"0_from"+c,e='style="background-image:url(images/'+a.src+');"',f='<div type="'+b+'" '+e+' delayTime="'+a.delayTime+'" animate="true" class="likePageBox '+c+' disNone" animateClass="'+d+'" fromClass="'+c+'" targetClass="'+a.from+'0">  </div>';return f},f=function(a,b){var c="animateToShow",d='style="background-image:url(images/'+a.src+');"',e='<div type="'+b+'" '+d+' delayTime="'+a.delayTime+'" animate="true" class="likePageBox opacity0 disNone" animateClass="'+c+'" >  </div>';return e};pageHtml='<div effect="'+c+'" type="'+b+'" '+styleStr+'  class="page lowZindex '+d+' disNone">';for(var g=0,h=animateImgs.length;h>g;g++){var i=animateImgs[g],j=i.type,k="";"move"===j?k=e(i,j):"fadeIn"===j&&(k=f(i,j)),pageHtml+=k}return"gallery"===b&&(pageHtml+='<div style="background-image:url(images/'+a.tipImg+');" state="hidden" tipImg="true" showClass="right0" hideClass="right100"  class="likePageBox right100" > </div>'),pageHtml+="</div>",pageHtml}function h(a,b,c){var d="",e=a.background,f=a.button,g=0;return d+='<div effect="fade" pageindex="'+c+'" class="page disNone"  type="'+b+'" style="background-image:url(images/'+e+')"><img class="showMapbutton" src="images/'+f+'" /><div class="videoBtnCover boBtnCover"></div>  <span class="mapCloseButton disNone" id="mapCloseButton" style="top:'+g+'px;"> 关闭 </span><div class="mapBox"><div class="mapContent" id="baidumapContent"></div></div> </div>'}function i(a,b){a.attr("hasEvt")||(a.bind("webkitAnimationEnd",function(){b($(this))}),a.attr("hasEvt",!0))}function j(){var a=E.pageList,b=a.filter('div[effect="120%"]'),c=a.filter('div[effect="fade"]'),d=a.filter('div[type="slide"]'),e=a.find('div[animate="true"]'),f=a.find('div[tipImg="true"]'),g=(a.find('div[slide="true"]'),a.filter('[type="360"]'),a.filter('[type="video"]')),h=a.eq(E.pageNum-1).find(".copyright_info"),j=a.find(".showMapbutton");app.fn.video.registerEvt(g);var k=j.clone().css({visibility:"hidden"}).appendTo($(document.body));setTimeout(function(){var a=k.width();a&&j.css({"margin-left":a/2*-1}),k.remove()},500),i(h,function(a){a.hasClass("copyright_info_show")&&a.removeClass("opacity0 copyright_info_show")}),i(c,function(a){a.hasClass("toOpacity100")&&a.removeClass("toOpacity100 opacity0")}),i(b,function(a){a.hasClass("toOpacity100fast")?a.removeClass("toOpacity100fast opacity0").addClass("toSize100"):a.hasClass("toSize100")&&a.removeClass("bigSize120 toSize100")}),i(e,function(a){var b=a.attr("animateClass"),c=a.attr("fromClass"),d=a.attr("targetClass"),e=a.attr("type");"move"===e?a.hasClass(b)&&a.addClass(d).removeClass(b+" "+c):"fadeIn"===e&&a.hasClass(b)&&a.removeClass(b+" opacity0")}),i(f,function(a){var b=a.attr("hideClass"),c=a.attr("showClass");a.hasClass("toright_hide")?(a.removeClass("toright_hide right0").addClass(b).attr("state","hidden"),E.rightTipBtn.css("background-image","url(images/icon/arrow_right_1.png)"),E.pageIsMove=!1):a.hasClass("toright_show")&&(a.removeClass("toright_show right100").addClass(c).attr("state","show"),E.rightTipBtn.css("background-image","url(images/icon/arrow_right_2.png)"),E.pageIsMove=!1)});var l=E.pageList.filter('[type="map"]'),m=l.find(".showMapbutton"),n=$("#baidumapContent").parent(),o=$("#mapCloseButton"),p=!1,q=Number(m.parent().attr("pageindex")),r=function(){E.leftArrow.addClass("disNone"),E.rightArrow.addClass("disNone")};m.bind("touchend",function(a){return n.show().css({top:"30%",visibility:"hidden"}),app.fn.baiduMapFun(app.contentPageList[q]),n.css({top:"100%",visibility:"visible",display:"none"}),p=!0,r(),E.upDownArrow.hide(),E.pageIsMove=!0,n.show().animate({top:"30%"},400),setTimeout(function(){o.css("opacity",1).removeClass("disNone")},400),a.stopPropagation(),a.preventDefault(),!1}),o.bind("touchend",function(a){return n.addClass("hideMapBox"),$(this).animate({opacity:0},500),E.upDownArrow.show(),E.pageIsMove=!1,a.stopPropagation(),a.preventDefault(),!1}),i(n,function(a){a.hasClass("showMapBox")?a.removeClass("showMapBox").css({top:"30%"}):a.hasClass("hideMapBox")&&a.removeClass("hideMapBox").hide().css({top:"110%"})}),d.each(function(){var a=$(this)[0];new Swipe(a,{startSlide:2,speed:400,auto:!1,continuous:!0,disableScroll:!1,stopPropagation:!1,callback:function(){},transitionEnd:function(){}})})}function k(){function a(){c=0,d=0,g=0,h=0}function b(a,b){if(!E.pageIsMove){var c=0;Math.abs(a)>E.pageSize.width/5&&Math.abs(a)>Math.abs(b)?l(a):Math.abs(b)>E.pageSize.height/5?(b>0?(c=E.curPageIndex-1,c=-1===c?E.pageNum-1:c):(c=E.curPageIndex+1,c=c===E.pageNum?0:c),r(c)):E.pageIsMove=!1}}{var c,d,e,f,g,h;E.pageList,E.pageSize.height/5,E.pageSize.width/5}E.pageIsMove=!1,E.pageContent.bind("touchstart",function(a){if(!E.pageIsMove){var b=event.touches[0];return c=b.pageX,d=b.pageY,a.stopPropagation(),a.preventDefault(),!1}}),E.pageContent.bind("touchmove",function(a){if(!E.pageIsMove){var b=event.touches[0];return g=b.pageX,h=b.pageY,a.stopPropagation(),a.preventDefault(),!1}}),E.pageContent.bind("touchend",function(i){return E.pageIsMove?void 0:(g||(g=c),h||(h=d),e=g-c,f=h-d,b(e,f),a(),i.stopPropagation(),i.preventDefault(),!1)})}function l(a){switch(E.curPageType=E.pageList.eq(E.curPageIndex).attr("type"),E.curPageType){case"gallery":o(a);break;case"360":n(a);break;case"album":m(a);break;default:E.pageIsMove=!1}}function m(a){if(!E.pageIsMove){var b=E.pageList.eq(E.curPageIndex),c=b.find(".albumImg"),d=(c.length,c.filter(":last"));d.addClass(a>0?"albumImgToRight":"albumImgToLeft")}}function n(a){if(!E.pageIsMove&&!E.page360IsPlay){var b=E.pageList.eq(E.curPageIndex),c=b.find('div[slideImg="true"]'),d=c.length,e=Number(b.attr("curShowIndex")),f=0,g=null;a>0?(f=e-1,-1===f&&(f=d-1)):(f=e+1,f===d&&(f=0)),E.pageIsMove=!0,g=c.eq(f),g.addClass("zIndex100 opacity0 toShow")}}function o(a){var b=E.pageList.eq(E.curPageIndex).find('div[tipImg="true"]'),c=b.attr("state");a>0?"show"===c?b.addClass("toright_hide"):E.pageIsMove=!1:"hidden"===c?b.addClass("toright_show"):E.pageIsMove=!1}function p(a,b,c,d,e){var f=c.attr("effect");if(E.curPageIndex=a,E.curPageType=d,e?(/120%/.test(f)&&c.addClass("toSize100"),E.upDownArrow.removeClass("disNone")):/120%/.test(f)?c.addClass("bigSize120 opacity0").show().addClass("toOpacity100fast"):/fade/.test(f)&&c.addClass("opacity0").show().addClass("toOpacity100"),b.removeClass("lowZindex highZindex").addClass("centerZindex"),setTimeout(function(){b.addClass("disNone").hide()},700),c.removeClass("disNone lowZindex centerZindex").addClass("highZindex"),q(b,c),/common|gallery/.test(d)){var g=c.find('div[animate="true"]');g.each(function(){var a=$(this),b=a.attr("fromClass"),c=a.attr("targetClass"),d=a.attr("type");"move"===d?a.removeClass(c).addClass(b):"fadeIn"===d&&a.removeClass(c+" disNone").addClass("opacity0")}),g.hide()}"gallery"===d?E.rightTipBtn.show():E.rightTipBtn.hide()}function q(a,b){var c=b.find(".copyright_info");c.length>0&&c.removeClass("copyright_info_show").addClass("copyright_info_show opacity0")}function r(a,b){var c=E.pageList.eq(a),d=c.find("div"),e=E.pageList.eq(E.curPageIndex),f=c.attr("effect"),g=c.attr("type"),h=800;if(E.curPageType=g,p(a,e,c,g,b),v(e,e.attr("type")),("common"===g||"gallery"===g)&&d.length>0){var i=0;"120%"===f&&(i=1800,b&&(i-=300)),setTimeout(function(){D(d,c,g)},i)}else"album"===g&&(h=0),setTimeout(function(){switch(E.pageIsMove=!1,g){case"360":A(c);break;case"slide":y(),x(c);break;case"album":z(),t(c)}},h)}function s(a){var b=a.find("img"),c=b.length;b.each(function(a){var b=$(this);b.removeClass("albumImgShow0 albumImgShow1 albumImgShow2 disNone"),b.addClass(c-2>a?"albumImgShow0":a===c-2?"albumImgShow1":"albumImgShow2"),c-3>a&&b.addClass("disNone")})}function t(a){var b=a.find("img"),c="albumImgShow0 albumImgShow1 albumImgShow2";E.pageIsMove=!0,b.removeClass(c),b.each(function(a){var b=$(this);!function(a,b){var c=a;a+1>2&&(c=2),setTimeout(function(){b.addClass("albumImgAnimate"+c).attr("init","true").css("z-index",a+1)},350*a)}(a,b)});i(b,function(a){var b=(a.attr("targetClass"),"albumImgAnimate0 albumImgAnimate1 albumImgAnimate2");if("true"===a.attr("init")){var c=a.index(),d=a.parent().find("img"),e=(d.length,"");e=c,c+1>2&&(e=2),a.addClass("albumImgShow"+e).removeAttr("init").removeClass(b),a.prev()&&a.prev().hasClass("albumImgShow"+e)&&a.prev().addClass("disNone"),0===a.next().length&&(E.pageIsMove=!1,y(),a.parent().find("img").removeAttr("style"),s(a.parent()))}else if(a.hasClass("albumImgToRight")||a.hasClass("albumImgToLeft")){var f=a.parent(),d=f.find("img");d.length>=3&&(a.insertBefore(d.eq(0)).addClass("albumImgShow0").removeClass(b+" albumImgToRight albumImgToLeft"),s(f))}})}function u(){setTimeout(function(){},1e3)}function v(a,b){switch(b){case"common":u(a);break;case"gallery":u(a);break;case"360":B(a);break;case"slide":C(a);break;case"album":w(a)}z()}function w(a){setTimeout(function(){var b=a.find("img");b.removeAttr("style class").addClass("albumImg")},900)}function x(a){if(!E.slidePageInit){var b=a.find(".likePageBox");a.attr("curShowIndex","0"),i(b,function(a){a.hasClass("toShow")&&(a.parent().find(".zIndex11").removeClass("zIndex11").end().attr("curShowIndex",a.attr("index")),a.removeClass("opacity0 toShow zIndex100").addClass("zIndex11"),E.pageIsMove=!1)}),E.slidePageInit=!0}}function y(){E.leftArrow.removeClass("disNone"),E.rightArrow.removeClass("disNone").removeAttr("style")}function z(){E.leftArrow.addClass("disNone"),E.rightArrow.addClass("disNone")}function A(a){var b=a.find('div[slideImg="true"]'),c=0,d=0;a.attr("curShowIndex",0),E.page360IsPlay=!0,curShowImg=b.eq(c),i(b,function(a){a.hasClass("toShow")&&(a.parent().find(".zIndex11").removeClass("zIndex11").end().attr("curShowIndex",a.attr("index")),a.removeClass("opacity0 toShow zIndex100").addClass("zIndex11"),E.pageIsMove=!1)});var e=function(a){E.page360Timer=setTimeout(function(){0===c&&d++,c++,c===b.length&&(c=0),curShowImg=b.eq(c),curShowImg.addClass("zIndex100 opacity0 toShow"),2>d?e(2900):(y(),E.page360IsPlay=!1)},1500)};e()}function B(a){clearTimeout(E.page360Timer),setTimeout(function(){a.attr("curShowIndex","0").addClass("disNone").find(".zIndex11").removeClass("zIndex11")},1e3)}function C(a){setTimeout(function(){a.attr("curShowIndex","0").addClass("disNone").find(".zIndex11").removeClass("zIndex11")},1e3)}function D(a,b,c){if(E.pageIsMove=!0,"gallery"===c){var d=b.find('div[tipImg="true"]');d.removeClass("right0").addClass("right100"),E.rightTipBtn.css("background-image","url(images/icon/arrow_right_1.png)")}a.show().each(function(){var a=$(this),b=(a.attr("fromClass"),a.attr("targetClass"),a.attr("animateclass")),c=Number(a.attr("delayTime")),d=a.attr("type");setTimeout(function(){"fadeIn"===d?a.removeClass("disNone").animate({opacity:1},1e3):a.removeClass("disNone").addClass(b)},c)}),setTimeout(function(){E.pageIsMove=!1},1e3)}var E=this;E=$.extend(E,app.instance.common),E.pageList=app.contentPageList,E.pageNum=E.pageList.length,E.curPageIndex=0,E.curPageType=app.contentPageList[0].type,E.pageIsMove=!1,a(),E.startPageOne=function(){E.curPageIndex=E.pageNum-1,r(0,!0)}};